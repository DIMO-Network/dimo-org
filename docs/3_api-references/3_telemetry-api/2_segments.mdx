---
sidebar_position: 3
---

import TwoColumnLayout from '@site/src/components/TwoColumnLayout';
import ParametersBlock from '@site/src/components/ParametersBlock';

# Vehicle Segments
Get segmented trip data from DIMO-connected vehicles.

## Overview

The `segments` resource serves as the "trips" part of the Telemetry API, allowing developers to gather trip data for vehicles.

## Detection Mechanism

Segments can be detected using different mechanisms. This is a crucial part of querying segments.

<ParametersBlock
  title="DetectionMechanism Enum"
  parameters={[
    {
      name: "ignitionDetection",
      description: "Ignition-based detection: Segments are identified by isIgnitionOn state transitions.\n\nMost reliable for vehicles with proper ignition signal support."
    },
    {
      name: "frequencyAnalysis",
      description: "Frequency analysis: Segments are detected by analyzing signal update patterns.\n\nUses pre-computed materialized view for optimal performance.\n\nIdeal for real-time APIs and bulk queries."
    },
    {
      name: "changePointDetection",
      description: "Change point detection: Uses CUSUM algorithm to detect statistical regime changes.\n\nMonitors cumulative deviation in signal frequency via materialized view.\n\nExcellent noise resistance with 100% accuracy match to ignition baseline.\n\nBest alternative when ignition signal is unavailable - same accuracy, same speed as frequency analysis."
    }
  ]}
/>

## segments

The `segments` query allows you to retrieve trip segments.

<TwoColumnLayout
  stickyRight={true}
  leftColumn={
    <div>
      <h3>Query Arguments</h3>
      <ParametersBlock
        title="Arguments"
        parameters={[
          {
            name: "tokenId",
            type: "Int!",
            required: true,
            description: "The vehicle token ID."
          },
          {
            name: "from",
            type: "Time!",
            required: true,
            description: "Start time of the range."
          },
          {
            name: "to",
            type: "Time!",
            required: true,
            description: "End time of the range."
          },
          {
            name: "mechanism",
            type: "DetectionMechanism!",
            required: false,
            description: "The method used to detect segments (default: frequencyAnalysis)."
          },
          {
            name: "config",
            type: "SegmentConfig",
            required: false,
            description: "Configuration for segment detection parameters."
          }
        ]}
      />

      <h3>Response Fields</h3>
       <ParametersBlock
        title="Fields"
        parameters={[
          {
            name: "startTime",
            type: "Time!",
            description: "Segment start timestamp (actual activity start transition)."
          },
          {
            name: "endTime",
            type: "Time",
            description: "Segment end timestamp (activity end after debounce period).\n\nNull if segment is ongoing (extends beyond query range)."
          },
          {
            name: "durationSeconds",
            type: "Int!",
            description: "Duration in seconds.\n\nIf ongoing: from start to query 'to' time.\n\nIf complete: from start to end."
          },
          {
            name: "isOngoing",
            type: "Boolean!",
            description: "True if segment extends beyond query time range (last activity is ongoing)."
          },
          {
            name: "startedBeforeRange",
            type: "Boolean!",
            description: "True if segment started before query time range.\n\nIndicates startTime may be approximate."
          }
        ]}
      />
    </div>
  }
  rightColumn={
    <div>
      <pre><code className="language-graphql">{`query getSegment {
  segments(
    tokenId: 117315,
    from: "2025-11-01T09:21:19Z",
    to: "2025-11-07T09:21:19Z",
    mechanism: frequencyAnalysis
    config: {
      signalCountThreshold: 10
      minIdleSeconds: 60
      minSegmentDurationSeconds: 120
    }
  ) {
    startTime
    endTime
    isOngoing
    durationSeconds
    startedBeforeRange
  }
}`}</code></pre>

      <h4>Response Example</h4>
      <pre><code className="language-json">{`{
  "data": {
    "segments": [
      {
        "startTime": "2025-11-01T21:07:00Z",
        "endTime": "2025-11-01T22:02:00Z",
        "isOngoing": false,
        "durationSeconds": 3300,
        "startedBeforeRange": false
      },
      {
        "startTime": "2025-11-01T22:15:00Z",
        "endTime": "2025-11-01T22:40:00Z",
        "isOngoing": false,
        "durationSeconds": 1500,
        "startedBeforeRange": false
      }
    ]
  }
}`}</code></pre>
    </div>
  }
/>
